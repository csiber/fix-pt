function markFixerAsFavorite(e){e=$(e);if(e.hasClass("favorite-fixer1")){var t=$(".promotionpage-details").attr("data-promotionpage-id");e.removeClass("favorite-fixer1").addClass("favorite-fixer2");$.ajax({url:"../../users/favorite/"+t,context:document})}else{var t=$(".promotionpage-details").attr("data-promotionpage-id");e.removeClass("favorite-fixer2").addClass("favorite-fixer1");$.ajax({url:"../../users/removeFav/"+t,context:document})}}function pageCreateFixRequestJS(){var e=$(".bootstrap-tagsinput > input");e.tagsinput({maxTags:5,confirmKeys:[ENTER_KEY,COMMA_KEY]})}var BASE_URL="http://127.0.0.1/ldsot3g3/public/";var ENTER_KEY=13;var COMMA_KEY=188;$(document).ready(function(){BASE_URL=window.location.toString().substring(0,window.location.toString().search("public"))+"public/";$("#buttonLogin").click(function(){$("#signInModal").ready(function(){$("#buttonForgotPass").click(function(){console.log("FAIL");$("#signInModal").modal("hide")})})});$("#removeNotifications").click(function(){$(".notifications-list").addClass("hide");$(".zeronot").removeClass("hide");var e="public/users/removenotifications";e=window.location.toString().substring(0,window.location.toString().search("public"))+e;$.ajax({type:"POST",url:e})});$(".dropdown select").change(function(){var e=this.getAttribute("name");var t=this.options[this.selectedIndex].value;$.ajax({type:"POST",url:BASE_URL+"users/change_permission",data:{id:e,user_type:t}}).done(function(e){window.location.replace("../users/index")})});$("#distritoshome").change(function(){var e=$("#concelhos");e.empty();e.append('<option value="">Escolha um concelho</option>');return $.ajax({type:"POST",url:BASE_URL+"search/getconcelhos",data:{did:$("#distritoshome").val()},success:function(t){for(var n=0;n<t.length;n++){e.append('<option value="'+t[n][0]+'">'+t[n][1]+"</option>")}return true},error:function(e){return alert("ERROR:"+e.responseText)}})});$("#distritos").change(function(){var e=$("#concelhos");e.empty();e.append('<option value="">Escolha um concelho</option>');return $.ajax({type:"POST",url:"search/getconcelhos",data:{did:$("#distritos").val()},success:function(t){for(var n=0;n<t.length;n++){e.append('<option value="'+t[n][0]+'">'+t[n][1]+"</option>")}return true},error:function(e){return alert("ERROR:"+e.responseText)}})});$("#district-home-search").typeahead({name:"districts",remote:BASE_URL+"districts/query/%QUERY",limit:5});$("#fixrequest-index-radios input[type='radio'").click(function(e){var t=$(".fixrequests").attr("data-sort");var n=window.location.toString().search("fixrequests/search");if(n!=-1){window.location=BASE_URL+"fixrequests/search/"+t+"/"+$(this).val()}else{window.location=BASE_URL+"fixrequests/index/"+t+"/"+$(this).val()}});$("#promotionpage-index-radios input[type='radio'").click(function(e){var t=$(".promotionpages").attr("data-sort");window.location=BASE_URL+"promotionpages/index/"+t+"/"+$(this).val()});$("#fixrequest-city").typeahead({name:"districts",remote:BASE_URL+"districts/query/%QUERY",limit:5});$("#fixrequest-location").typeahead({name:"concelhos",remote:{url:BASE_URL+"concelhos/query/%QUERY",replace:function(e,t){var n="concelhos/query/"+t;if($("#fixrequest-city").val()){n+="/"+encodeURIComponent($("#fixrequest-city").val())}return BASE_URL+n}},limit:5});$("#promotionpage-city").typeahead({name:"districts",remote:BASE_URL+"districts/query/%QUERY",limit:5});$("#promotionpage-location").typeahead({name:"concelhos",remote:{url:BASE_URL+"concelhos/query/%QUERY",replace:function(e,t){var n="concelhos/query/"+t;if($("#promotionpage-city").val()){n+="/"+encodeURIComponent($("#promotionpage-city").val())}return BASE_URL+n}},limit:5});$(".show_comments").click(function(){$(".comment").each(function(){$(this).removeClass("hide")});$(this).remove()});$("#create_comment_form button").click(function(e){var t=$("#create_comment_form");var n=t.find("textarea").val().trim();var r=$(".fixrequest").attr("data-fix-request-id");var i='               <ul class="media-list comment">                 <li class="media">                     <a class="pull-left" href="#">                         <img class="media-object" src="${gravatar}" alt="...">                     </a>                     <div class="media-body">                         <h5 class="media-heading"><a href="#">${username}</a><span> - ${created_at}</span></h5>                         ${text}             </div></li></ul>';$.template("commentTemplate",i);$.ajax({url:BASE_URL+"comments/create",type:"POST",dataType:"json",data:{text:n,fix_request_id:r}}).done(function(e){if(e.result==="OK"){$.tmpl("commentTemplate",{gravatar:e.comment.gravatar,username:e.comment.username,created_at:e.comment.created_at_pretty,text:e.comment.text}).appendTo(".comment-list");$(".comments .lead .counter").html($(".comment").length);t.find("textarea").val("")}else{alert("Something went wrong. Try again.")}})});$(".fancybox").fancybox();$(".fixrequests .panel").each(function(){$(this).click(function(){var e=$(this).find("h4 a").attr("href");window.location.href=e})});$(".searchresults .panel").each(function(){$(this).click(function(){var e=$(this).find("h4 a").attr("href");window.location.href=e})});$(".fixoffer .accept").click(function(e){var t=$(".fixrequest").attr("data-fix-request-id");var n=$(e.target).parents(".fixoffer").attr("data-fixer-id");var r=$(".fixoffer").attr("data-fix-offer-id");$.ajax({url:BASE_URL+"jobs/create",type:"POST",data:{fix_request_id:t,fixer_id:n,fix_offer_id:r},dataType:"json"}).done(function(e){console.log(e);if(e.result==="OK"){window.location.reload(true)}else{alert("Something went wrong. Pleasy try again later")}})});$("#create_fix_offer_form").submit(function(e){e.preventDefault()});$("#give_rating_form").submit(function(e){e.preventDefault()});$("#give_rating_form button").click(function(e){var t=$("#give_rating_form");var n=t.find("textarea").val().trim();var r=t.parent(".job").attr("data-job-id");var i=t.find("input[name='job_rating']").val();$.ajax({url:BASE_URL+"jobs/rate",type:"POST",data:{feedback:n,score:i,job_id:r},dataType:"json"}).done(function(e){console.log(e);if(e.result==="OK"){window.location.reload(true)}else{alert("Something went wrong. Pleasy try again later")}})});$("#create_fix_offer_form button").click(function(e){var t=$("#create_fix_offer_form");var n=t.find("textarea").val().trim();var r=t.find('input[type="number"]').val();var i=$(".fixrequest").attr("data-fix-request-id");var s='             <ul class="media-list fixoffer">                 <li class="media">                     <a href="#" class="pull-left"><img src="${gravatar}" alt="" class="media-object"></a>                     <div class="media-body">                         <h5 class="media-heading"><a href="#">${username}</a><span> - ${created_at}</span></h5>                         ${text}                         <h5>Value: ${value}â‚¬</h5>             </div></li></ul>';$.template("fixOfferTemplate",s);$.ajax({url:BASE_URL+"fixoffers/create",type:"POST",data:{text:n,value:r,fix_request_id:i},dataType:"json"}).done(function(e){console.log(e);if(e.result==="OK"){$.tmpl("fixOfferTemplate",{gravatar:e.fixoffer.gravatar,username:e.fixoffer.username,created_at:e.fixoffer.created_at_pretty,text:e.fixoffer.text,value:e.fixoffer.value}).appendTo(".fixoffers-list");$("#create_fix_offer_form").remove();$(".fix-offers .lead .counter").html($(".fixoffer").length)}else{if(e.error_code==1){alert("The input is invalid. Text must be at least 20 characters long and the value has to be an integer")}}})});window.addEventListener("load",function(){new FastClick(document.body)},false)})